# =============================================================================
# AAM Infrastructure — PROD Stack Configuration
# =============================================================================
# Purpose : Production
# Trigger : main branch / tagged releases
# GCP Project : aamregistry
# =============================================================================

config:
  aam-infra:environment: prod
  aam-infra:gcp_project: aamregistry
  aam-infra:gcp_region: us-central1

  # ---------------------------------------------------------------------------
  # Cloud Run — Backend
  # ---------------------------------------------------------------------------
  aam-infra:backend_image: us-central1-docker.pkg.dev/aamregistry/aam/backend:latest
  aam-infra:backend_cpu: "2"
  aam-infra:backend_memory: 2Gi
  aam-infra:backend_min_instances: 2
  aam-infra:backend_max_instances: 10
  aam-infra:backend_concurrency: 100

  # ---------------------------------------------------------------------------
  # Cloud Run — Web
  # ---------------------------------------------------------------------------
  aam-infra:web_image: us-central1-docker.pkg.dev/aamregistry/aam/web:latest
  aam-infra:web_cpu: "1"
  aam-infra:web_memory: 512Mi
  aam-infra:web_min_instances: 2
  aam-infra:web_max_instances: 8

  # ---------------------------------------------------------------------------
  # Cloud SQL — PostgreSQL
  # ---------------------------------------------------------------------------
  aam-infra:db_tier: db-custom-2-7680
  aam-infra:db_disk_size_gb: 50
  aam-infra:db_high_availability: true
  aam-infra:db_backup_enabled: true

  # ---------------------------------------------------------------------------
  # Memorystore — Redis
  # ---------------------------------------------------------------------------
  aam-infra:redis_tier: STANDARD_HA
  aam-infra:redis_memory_size_gb: 2

  # ---------------------------------------------------------------------------
  # GCS — Package Storage
  # ---------------------------------------------------------------------------
  aam-infra:storage_location: US
  aam-infra:storage_class: STANDARD

  # ---------------------------------------------------------------------------
  # Domain / Networking
  # ---------------------------------------------------------------------------
  aam-infra:domain: aam.example.com
  aam-infra:enable_cdn: true
